import{u as L,a as $,r as B,l as g,o as R,w as T,c as o,b as t,d as _,e as i,f as m,m as U,R as j,g as v,p as I,F,j as M,t as d,k as n,q as V,n as y,s as Y,x as E,y as q,z,A as P}from"./index-DmDlVIj_.js";const W={class:"container mx-auto px-4 py-6 max-w-6xl"},G={class:"flex flex-col md:flex-row gap-6"},H={class:"flex-1"},J={class:"bg-light-secondary dark:bg-dark-secondary rounded-lg shadow"},K={class:"border-b border-light-neutral-200 dark:border-dark-neutral-700 px-4 py-4 sm:px-6"},O={class:"flex items-center justify-between"},Q={class:"flex items-center space-x-2"},X=["disabled"],Z={key:0,class:"px-4 py-8 sm:px-6 text-center"},ee={key:1,class:"px-4 py-8 sm:px-6 text-center"},te={key:2,class:"px-4 py-8 sm:px-6 text-center"},re={class:"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-500 p-4 rounded"},se={class:"flex"},ae={class:"shrink-0"},ne={key:3,class:"px-4 py-8 sm:px-6 text-center"},oe={class:"mb-4"},ie={key:4,class:"divide-y divide-light-neutral-200 dark:divide-dark-neutral-700"},de={class:"shrink-0 pt-0.5"},le={class:"ml-4 flex-1"},ce={class:"flex items-center justify-between"},ue={class:"font-medium text-light-text-primary dark:text-dark-text-primary"},xe={class:"text-xs text-light-text-tertiary dark:text-dark-neutral-500"},ge={class:"mt-1 text-light-text-secondary dark:text-dark-neutral-400"},me={class:"mt-2 flex justify-between items-center"},ye=["onClick"],fe={key:5,class:"px-4 py-3 bg-light-tertiary dark:bg-dark-tertiary sm:px-6 flex justify-between items-center"},ke={class:"text-sm text-light-text-secondary dark:text-dark-neutral-400"},be={__name:"Notifications",setup(pe){const u=L(),a=$(),l=B(!0),f={success:P,error:z,info:q,warning:v},k={success:"text-green-500",error:"text-red-500",info:"text-blue-500",warning:"text-yellow-500"},p={success:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200",error:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200",info:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200",warning:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-200"},w=g(()=>[...a.userNotifications].sort((s,e)=>{if(!s.read&&e.read)return-1;if(s.read&&!e.read)return 1;const r=s.createdAt instanceof Date?s.createdAt:new Date(s.createdAt);return(e.createdAt instanceof Date?e.createdAt:new Date(e.createdAt))-r})),h=g(()=>a.userNotifications.filter(s=>!s.read).length),D=g(()=>h.value>0),A=s=>{if(!s)return"";const e=new Date,r=new Date(s);if(r.toDateString()===e.toDateString())return`Today at ${r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`;const c=new Date(e);if(c.setDate(e.getDate()-1),r.toDateString()===c.toDateString())return`Yesterday at ${r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`;const b=new Date(e);if(b.setDate(e.getDate()-7),r>b){const x={weekday:"long"};return`${r.toLocaleDateString(void 0,x)} at ${r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`}if(r.getFullYear()===e.getFullYear()){const x={month:"short",day:"numeric"};return r.toLocaleDateString(void 0,x)}return r.toLocaleDateString()},N=async s=>{try{await a.markAsRead(s.id)}catch(e){console.error("Error marking notification as read:",e)}},S=async()=>{try{const s=a.userNotifications.filter(e=>!e.read);for(const e of s)await a.markAsRead(e.id)}catch(s){console.error("Error marking all notifications as read:",s)}},C=()=>{a.indexCreationUrl?window.open(a.indexCreationUrl,"_blank"):console.warn("Index creation URL is not available")};return R(()=>{u.user&&a.loadUserNotifications(),l.value=!1}),T(()=>u.user,s=>{s&&(l.value=!0,a.loadUserNotifications(),l.value=!1)}),(s,e)=>(n(),o("div",W,[t("div",G,[t("div",H,[t("div",J,[t("div",K,[t("div",O,[e[0]||(e[0]=t("h2",{class:"text-xl font-semibold text-light-text-primary dark:text-dark-text-primary"}," Notifications ",-1)),t("div",Q,[t("button",{onClick:S,class:"inline-flex items-center px-3 py-1.5 border border-orange-600 text-sm font-medium rounded-md text-orange-600 bg-white dark:bg-dark-secondary hover:bg-orange-600 hover:text-white transition-colors",disabled:!D.value}," Mark all as read ",8,X)])])]),l.value?(n(),o("div",Z,e[1]||(e[1]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-r-2 border-accent-primary"},null,-1),t("p",{class:"mt-2 text-light-text-secondary dark:text-dark-neutral-400"},"Loading notifications...",-1)]))):i(u).user?i(a).indexMissing?(n(),o("div",te,[t("div",re,[t("div",se,[t("div",ae,[m(i(v),{class:"h-5 w-5 text-yellow-400","aria-hidden":"true"})]),t("div",{class:"ml-3"},[e[4]||(e[4]=t("p",{class:"text-sm text-yellow-700 dark:text-yellow-200"}," Database setup required. The notifications system needs a database index. ",-1)),t("div",{class:"mt-2"},[t("button",{onClick:C,class:"px-2 py-1 rounded bg-orange-600 hover:bg-orange-700 text-white text-xs font-medium"}," Create Index ")])])])])])):i(a).userNotifications.length===0?(n(),o("div",ne,[t("div",oe,[m(i(I),{class:"h-12 w-12 text-light-neutral-400 dark:text-dark-neutral-500 mx-auto"})]),e[5]||(e[5]=t("p",{class:"text-light-text-secondary dark:text-dark-neutral-400"},"You don't have any notifications yet.",-1))])):(n(),o("div",ie,[(n(!0),o(F,null,M(w.value,r=>(n(),o("div",{key:r.id,class:y(["px-4 py-4 sm:px-6 flex",r.read?"bg-light-primary dark:bg-dark-primary":"bg-light-neutral-50 dark:bg-dark-neutral-800"])},[t("div",de,[(n(),Y(E(f[r.type]||f.info),{class:y(["h-6 w-6",k[r.type]||k.info]),"aria-hidden":"true"},null,8,["class"]))]),t("div",le,[t("div",ce,[t("p",ue,d(r.title),1),t("p",xe,d(A(r.createdAt)),1)]),t("p",ge,d(r.message),1),t("div",me,[t("div",{class:y(["inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium",p[r.type]||p.info])},d(r.type),3),r.read?_("",!0):(n(),o("button",{key:0,onClick:c=>N(r),class:"text-sm text-orange-600 hover:underline"}," Mark as read ",8,ye))])])],2))),128))])):(n(),o("div",ee,[e[3]||(e[3]=t("p",{class:"text-light-text-secondary dark:text-dark-neutral-400"},"Please sign in to view your notifications.",-1)),m(i(j),{to:"/login",class:"mt-2 inline-block text-accent-primary hover:underline"},{default:U(()=>e[2]||(e[2]=[V("Sign in")])),_:1})])),i(a).userNotifications.length>0?(n(),o("div",fe,[t("span",ke,d(h.value)+" unread notifications ",1)])):_("",!0)])])])]))}};export{be as default};
//# sourceMappingURL=Notifications-wNmlI8Du.js.map
